#!/bin/sh

VDBDUMP=$(which vdb-dump) || exit $?

${VDBDUMP} -E ${1} | grep -q -e "tbl\s*:\s*PRIMARY_ALIGNMENT" \
&& ${VDBDUMP} -f tab ${1} -T PRIMARY_ALIGNMENT -C "READ,REF_NAME,REF_POS,REF_ORIENTATION,CIGAR_SHORT,SEQ_SPOT_GROUP"

${VDBDUMP} -E ${1} | grep -q -e "tbl\s*:\s*SECONDARY_ALIGNMENT" \
&& ${VDBDUMP} -f tab ${1} -T SECONDARY_ALIGNMENT -C "READ,REF_NAME,REF_POS,REF_ORIENTATION,CIGAR_SHORT,SEQ_SPOT_GROUP"

${VDBDUMP} -f tab ${1} -C "CMP_READ,READ_LEN,READ_START,READ_TYPE,PRIMARY_ALIGNMENT_IDS,SPOT_GROUP" \
&& exit 0

${VDBDUMP} -f tab ${1} -C "READ,READ_LEN,READ_START,READ_TYPE,SPOT_GROUP"
